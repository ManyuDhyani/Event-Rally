<div class="container">
    <div class = "card-wrapper">
        <div class = "card">
            <!-- card left -->
            <div class = "event-imgs">
                <div class = "img-display">
                <div class = "img-showcase">
                    <img src = "\public\uploads\events/{{ event.thumbnail_1 }}" alt = "{{ event.title }}">
                    <img src = "\public\uploads\events/{{ event.thumbnail_2 }}" alt = "{{ event.title }}">
                    <img src = "\public\uploads\events/{{ event.thumbnail_3 }}" alt = "{{ event.title }}">
                    <img src = "\public\uploads\events/{{ event.thumbnail_4 }}" alt = "{{ event.title }}">
                </div>
                </div>
                <div class = "img-select">
                <div class = "img-item">
                    <a href = "#" data-id = "1">
                    <img src = "\public\uploads\events/{{ event.thumbnail_1 }}" alt = "{{event.title}}" style="width:100%;height:auto;">
                    </a>
                </div>
                <div class = "img-item">
                    <a href = "#" data-id = "2">
                    <img src = "\public\uploads\events/{{ event.thumbnail_2 }}" alt = "{{event.title}}" style="width:100%;height:auto;">
                    </a>
                </div>
                <div class = "img-item">
                    <a href = "#" data-id = "3">
                    <img src = "\public\uploads\events/{{ event.thumbnail_3 }}" alt = "{{event.title}}" style="width:100%;height:auto;">
                    </a>
                </div>
                <div class = "img-item">
                    <a href = "#" data-id = "4">
                    <img src = "\public\uploads\events/{{ event.thumbnail_4 }}" alt = "{{ event.title }}" style="width:100%;height:auto;">
                    </a>
                </div>
                </div>
            </div>
            <!-- card right -->
            <div class = "event-content">
                <h2 class = "event-title" style="margin-top: 2rem;">{{event.title}}</h2>
                <a href = "#" class = "event-link" style="background: #5fc7f4;"><strong>{{event.category}}</strong></a>
    
                <div class = "event-price">
                    <p class = "price">Price: <span><i class = "fa fa-dollar" style="color: rgb(13, 13, 13);"></i> {{event.price}}</span></p>
                </div>
    
                <div class = "event-detail">
                    <h2>Overview: </h2>
                    <p>{{event.overview}}</p>
                    <ul>
                        <li><i class = "fa fa-car" style="color: rgb(13, 13, 13);"></i> &nbsp; Location: <span>{{ event.location }}</span></li>
                        <li><i class="fa fa-arrow-circle-right"></i> &nbsp; Time of posting: <span>{{ event.created }}</span></li>
                    </ul>
                </div>
    
                <!-- Check if user has bought Ticket (Attending), no need to show Buy Button-->
                <div class = "purchase-info">
                    
                    <button type = "button" class = "btn">
                        Attend Event <i class = "fa fa-paypal"></i>
                    </button>
                    <button type = "button" class = "btn" id="follow_btn">Follow Event <i class = "fa fa-hand-spock-o"></i></button>
                </div>
                <div class="feedback-info">
                    <button type="button" class="btn" id="like_btn"><i class="fa fa-thumbs-up"></i></button> 
                    <button type="button" class="btn" id="dislike_btn"><i class="fa fa-thumbs-down"></i></button> 
                </div>
            </div>
        </div>
    </div>
    <br>
    <br>
    <div class="container" style="max-width: 1100px; margin: auto auto; padding: 2rem 1rem;; margin-top: -8%;">
        <div class="col-12">
            <h3 style="margin-top: 2rem;">About {{ event.title }}</h3>
            {{event.content}}
        </div>
    </div>
    <!--Comments-->
    <header>
        <h3>Comments</h3>
    </header>
    <!--load comments and then comment form-->
    {{#each parentComments}}
        <div class="card">
            <div class="card-body">
                <div class="d-flex flex-start align-items-center">
                    <h6 class="fw-bold text-primary mb-1">{{this.user_name}}</h6>
                    <p class="text-muted small mb-0">
                        Shared publicly - {{this.timestamp}}
                    </p>
                </div>
            </div>
            <p class="mt-3 mb-4 pb-2">
                {{this.content}}
            </p>
            <!--Comment Options: View Thread, Reply, Delete-->
            <footer class="small">
                <a class="comment-reply-btn" href="#">{{#eq childrenCount 1 }} View 1 Reply {{/eq}} {{#gt childrenCount 1 }}View {{ childrenCount }} Replies{{/gt}}</a>
                {{#gt childrenCount 0 }}&nbsp;|{{/gt}}<a class="comment-reply-btn" href="#">&nbsp;Reply&nbsp;</a> 
                {{is_authenticated}}
                {{#if is_authenticated}}h 
                {{#eq user._id this._id}} |<a class="confirm-delete" href='/comments/{{this._id}}'>&nbsp;Delete</a> {{/eq}}
                {{/if}} 
            </footer>
        </div>
        <hr>
    {{/each}}
    <!--Comment Form-->
    {{#if is_authenticated}}
        <header>
            <h3>Leave a Comment</h3>
        </header>
        <form action="/comments/create" method="post">
            <input type="hidden" id="userID" name="eventID" value="{{event._id}}">
            <div class="form-group col-md-6">
                <textarea name="content" cols="40" rows="4" class="form-control" placeholder="Type your comment...." id="parentComment" required>
                </textarea>
            </div>
            <div class="form-group col-md-6">
                <button type="submit" class="btn btn-secondary">Submit</button>
            </div>
        </form>
    {{/if}}
    <br><br>
    <!--Maps-->
    <div id="map"></div>
    <p id="hidden_location" hidden>{{event.location}}</p>
    <p id="hidden_user_id" hidden>{{user._id}}</p>
    <p id="hidden_event_id" hidden>{{event._id}}</p>
</div>
<script src="../../public/js/eventInteraction.js"></script>
<script>
    //call geocode function for setting lat and long for marker on maps
    geocode();
    //this function gets lat and lon of the address provided and places the marker on the google map on that location
    function geocode()
    {
        let location_temp = document.getElementById('hidden_location').innerHTML;
        axios.get('https://maps.googleapis.com/maps/api/geocode/json',{
        params:{
          address:location_temp,
          key:'AIzaSyDcRs0sa21dO5jEBhHPoOq0sUClaWHwung'
        }
      })
      .then(function(response){
        // Geometry
        var lat = response.data.results[0].geometry.location.lat;
        var lng = response.data.results[0].geometry.location.lng;
        let loc ={lat:lat,lng:lng};
        addMarker(loc);
      })
      .catch(function(error){
        console.log(error);
      });
    }
</script>
